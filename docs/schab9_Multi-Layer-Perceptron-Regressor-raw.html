---

title: Multi-Layer Perceptron Regressor


keywords: fastai
sidebar: home_sidebar

summary: "for more information about MLP-regressor follow the <a href='https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html?highlight=multi%20layer%20perceptron%20regressor'>link</a>"
description: "for more information about MLP-regressor follow the <a href='https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html?highlight=multi%20layer%20perceptron%20regressor'>link</a>"
nb_path: "notebooks/test/notebook/schab9_Multi-Layer-Perceptron-Regressor-raw.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/test/notebook/schab9_Multi-Layer-Perceptron-Regressor-raw.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-libraries">Import libraries<a class="anchor-link" href="#Import-libraries"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># reload all modules every time before executing Python code</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># render plots in notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">dslectures.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># data viz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;muted&quot;</span><span class="p">))</span>

<span class="c1"># ml magic</span>
<span class="c1"># scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>


<span class="kn">from</span> <span class="nn">pandas.api.types</span> <span class="kn">import</span> <span class="n">is_object_dtype</span><span class="p">,</span> <span class="n">is_numeric_dtype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-the-data">Load the data<a class="anchor-link" href="#Load-the-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also make use of the <code>pathlib</code> library to handle our filepaths:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">ls</span> {datapath}
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-intense-fg ansi-bold">processed</span>/ <span class="ansi-cyan-intense-fg ansi-bold">raw</span>/
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">/</span><span class="s1">&#39;raw/train.csv&#39;</span><span class="p">);</span> <span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">();</span> <span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>artist_name</th>
      <td>Netherfriends</td>
      <td>Maxo Kream</td>
      <td>Drebae</td>
      <td>TWICE</td>
      <td>Lisa Howard</td>
    </tr>
    <tr>
      <th>track_id</th>
      <td>7luDJV4DDZmjH3QDdCqpcO</td>
      <td>1F09jtMfeYNkUj6piQjXwM</td>
      <td>2tR2VS8rAndKb0C5hS3IpD</td>
      <td>1U3cHXWaa0FqlUWLLBL7Kz</td>
      <td>1vAP99gg1HzuUUITxJPdyn</td>
    </tr>
    <tr>
      <th>track_name</th>
      <td>Money Everyday</td>
      <td>ATW</td>
      <td>Trust in Me (feat. Allura)</td>
      <td>BRAND NEW GIRL</td>
      <td>Cheeseburger In Paradise</td>
    </tr>
    <tr>
      <th>acousticness</th>
      <td>0.0722</td>
      <td>0.155</td>
      <td>0.239</td>
      <td>0.016</td>
      <td>0.281</td>
    </tr>
    <tr>
      <th>danceability</th>
      <td>0.79</td>
      <td>0.677</td>
      <td>0.661</td>
      <td>0.674</td>
      <td>0.607</td>
    </tr>
    <tr>
      <th>duration_ms</th>
      <td>186410</td>
      <td>149967</td>
      <td>231732</td>
      <td>213956</td>
      <td>228556</td>
    </tr>
    <tr>
      <th>energy</th>
      <td>0.384</td>
      <td>0.747</td>
      <td>0.625</td>
      <td>0.965</td>
      <td>0.771</td>
    </tr>
    <tr>
      <th>instrumentalness</th>
      <td>1.72e-06</td>
      <td>0</td>
      <td>0</td>
      <td>9.59e-05</td>
      <td>5.29e-06</td>
    </tr>
    <tr>
      <th>key</th>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>liveness</th>
      <td>0.1</td>
      <td>0.239</td>
      <td>0.0971</td>
      <td>0.145</td>
      <td>0.221</td>
    </tr>
    <tr>
      <th>loudness</th>
      <td>-11.201</td>
      <td>-5.68</td>
      <td>-8.09</td>
      <td>-3.754</td>
      <td>-5.106</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>speechiness</th>
      <td>0.231</td>
      <td>0.318</td>
      <td>0.101</td>
      <td>0.0696</td>
      <td>0.112</td>
    </tr>
    <tr>
      <th>tempo</th>
      <td>156.077</td>
      <td>153.921</td>
      <td>132.899</td>
      <td>157.041</td>
      <td>138.087</td>
    </tr>
    <tr>
      <th>time_signature</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>valence</th>
      <td>0.203</td>
      <td>0.371</td>
      <td>0.385</td>
      <td>0.75</td>
      <td>0.496</td>
    </tr>
    <tr>
      <th>popularity</th>
      <td>2</td>
      <td>41</td>
      <td>9</td>
      <td>41</td>
      <td>19</td>
    </tr>
    <tr>
      <th>collection_date</th>
      <td>april-2019</td>
      <td>april-2019</td>
      <td>april-2019</td>
      <td>april-2019</td>
      <td>april-2019</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">/</span><span class="s1">&#39;raw/test.csv&#39;</span><span class="p">);</span> <span class="n">test_data</span><span class="o">.</span><span class="n">head</span><span class="p">();</span> <span class="n">test_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>artist_name</th>
      <td>Supriya Lohith</td>
    </tr>
    <tr>
      <th>track_id</th>
      <td>7rrY55kdGxRC65rfeeJkG0</td>
    </tr>
    <tr>
      <th>track_name</th>
      <td>Nade Nade</td>
    </tr>
    <tr>
      <th>acousticness</th>
      <td>0.485</td>
    </tr>
    <tr>
      <th>danceability</th>
      <td>0.764</td>
    </tr>
    <tr>
      <th>duration_ms</th>
      <td>192000</td>
    </tr>
    <tr>
      <th>energy</th>
      <td>0.605</td>
    </tr>
    <tr>
      <th>instrumentalness</th>
      <td>1.19e-05</td>
    </tr>
    <tr>
      <th>key</th>
      <td>2</td>
    </tr>
    <tr>
      <th>liveness</th>
      <td>0.0915</td>
    </tr>
    <tr>
      <th>loudness</th>
      <td>-6.088</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>1</td>
    </tr>
    <tr>
      <th>speechiness</th>
      <td>0.0303</td>
    </tr>
    <tr>
      <th>tempo</th>
      <td>94.991</td>
    </tr>
    <tr>
      <th>time_signature</th>
      <td>4</td>
    </tr>
    <tr>
      <th>valence</th>
      <td>0.399</td>
    </tr>
    <tr>
      <th>collection_date</th>
      <td>april-2019</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h4 id="Exercise-#1">Exercise #1<a class="anchor-link" href="#Exercise-#1"> </a></h4><p>Even though you may be told a dataset has been cleaned and prepared for training a model, you should always perform some sanity checks!</p>
<ul>
<li>Check that <code>housing_data</code> is free of missing values</li>
<li>Check that all columns are numerical</li>
</ul>
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>artist_name         0
track_id            0
track_name          0
acousticness        0
danceability        0
duration_ms         0
energy              0
instrumentalness    0
key                 0
liveness            0
loudness            0
mode                0
speechiness         0
tempo               0
time_signature      0
valence             0
popularity          0
collection_date     0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>artist_name          object
track_id             object
track_name           object
acousticness        float64
danceability        float64
duration_ms           int64
energy              float64
instrumentalness    float64
key                   int64
liveness            float64
loudness            float64
mode                  int64
speechiness         float64
tempo               float64
time_signature        int64
valence             float64
popularity            int64
collection_date      object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">getting_rid_features</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;artist_name&quot;</span><span class="p">,</span> <span class="s2">&quot;track_id&quot;</span><span class="p">,</span> <span class="s2">&quot;track_name&quot;</span><span class="p">,</span><span class="s2">&quot;collection_date&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">convert_strings_to_categories</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_object_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">/</span><span class="s1">&#39;processed/train_data_processed_schab9.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Select-a-performance-measure">Select a performance measure<a class="anchor-link" href="#Select-a-performance-measure"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we can train any model, we need to think about which performance measure we wish to optimise for. For regression problems the Root Mean Square Error (RMSE) is often used as it measures the <em><strong>standard deviation</strong></em> of the errors the algorithm makes in its predictions and gives a higher weight to large errors. For example, an RMSE equal to 50,000 means that about 68% of the algorithm's predictions fall within 50,000 CHF of the actual value, and about 95% fall within 100,000 CHF.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='In general, lower values of RMSE indicate a better fit to the data.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mathematically, the formula for RMSE is:</p>
<p>{% raw %}
$$\mathrm{RMSE} = \sqrt{\frac{1}{m}\sum_{i=1}^m \left(\hat{y}_i - y_i\right)^2}$$
{% endraw %}</p>
<p><em>One possibility to calculate the deviation</em></p>
<p>where $m$ is the number of instances in the dataset you are measuring the RMSE on, $\hat{y}_i$ is the model's prediction for the $i^{th}$ instance, and $y_i$ is the actual label. Let's create a simple function that uses scitkit-learn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_squared_error.html">mean_squared_error function</a> (which is just RMSE$^2$):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A utility function to calculate the Root Mean Square Error (RMSE).</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        y (array): Actual values for target.</span>
<span class="sd">        yhat (array): Predicted values for target.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        rmse (double): The RMSE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Multi-Layer-Perceptron-Regressor">The Multi-Layer Perceptron Regressor<a class="anchor-link" href="#The-Multi-Layer-Perceptron-Regressor"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">getting_rid_features</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>acousticness</th>
      <td>0.072200</td>
      <td>0.155</td>
      <td>0.2390</td>
      <td>0.016000</td>
      <td>0.281000</td>
    </tr>
    <tr>
      <th>danceability</th>
      <td>0.790000</td>
      <td>0.677</td>
      <td>0.6610</td>
      <td>0.674000</td>
      <td>0.607000</td>
    </tr>
    <tr>
      <th>duration_ms</th>
      <td>186410.000000</td>
      <td>149967.000</td>
      <td>231732.0000</td>
      <td>213956.000000</td>
      <td>228556.000000</td>
    </tr>
    <tr>
      <th>energy</th>
      <td>0.384000</td>
      <td>0.747</td>
      <td>0.6250</td>
      <td>0.965000</td>
      <td>0.771000</td>
    </tr>
    <tr>
      <th>instrumentalness</th>
      <td>0.000002</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>0.000096</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>key</th>
      <td>7.000000</td>
      <td>6.000</td>
      <td>6.0000</td>
      <td>7.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>liveness</th>
      <td>0.100000</td>
      <td>0.239</td>
      <td>0.0971</td>
      <td>0.145000</td>
      <td>0.221000</td>
    </tr>
    <tr>
      <th>loudness</th>
      <td>-11.201000</td>
      <td>-5.680</td>
      <td>-8.0900</td>
      <td>-3.754000</td>
      <td>-5.106000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>1.000000</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>speechiness</th>
      <td>0.231000</td>
      <td>0.318</td>
      <td>0.1010</td>
      <td>0.069600</td>
      <td>0.112000</td>
    </tr>
    <tr>
      <th>tempo</th>
      <td>156.077000</td>
      <td>153.921</td>
      <td>132.8990</td>
      <td>157.041000</td>
      <td>138.087000</td>
    </tr>
    <tr>
      <th>time_signature</th>
      <td>4.000000</td>
      <td>4.000</td>
      <td>4.0000</td>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>valence</th>
      <td>0.203000</td>
      <td>0.371</td>
      <td>0.3850</td>
      <td>0.750000</td>
      <td>0.496000</td>
    </tr>
    <tr>
      <th>popularity</th>
      <td>2.000000</td>
      <td>41.000</td>
      <td>9.0000</td>
      <td>41.000000</td>
      <td>19.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Arrange-data-into-a-feature-matrix-and-target-vector">Arrange data into a feature matrix and target vector<a class="anchor-link" href="#Arrange-data-into-a-feature-matrix-and-target-vector"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0722</td>
      <td>0.790</td>
      <td>186410</td>
      <td>0.384</td>
      <td>0.000002</td>
      <td>7</td>
      <td>0.1000</td>
      <td>-11.201</td>
      <td>1</td>
      <td>0.2310</td>
      <td>156.077</td>
      <td>4</td>
      <td>0.203</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1550</td>
      <td>0.677</td>
      <td>149967</td>
      <td>0.747</td>
      <td>0.000000</td>
      <td>6</td>
      <td>0.2390</td>
      <td>-5.680</td>
      <td>0</td>
      <td>0.3180</td>
      <td>153.921</td>
      <td>4</td>
      <td>0.371</td>
      <td>41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2390</td>
      <td>0.661</td>
      <td>231732</td>
      <td>0.625</td>
      <td>0.000000</td>
      <td>6</td>
      <td>0.0971</td>
      <td>-8.090</td>
      <td>0</td>
      <td>0.1010</td>
      <td>132.899</td>
      <td>4</td>
      <td>0.385</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0160</td>
      <td>0.674</td>
      <td>213956</td>
      <td>0.965</td>
      <td>0.000096</td>
      <td>7</td>
      <td>0.1450</td>
      <td>-3.754</td>
      <td>1</td>
      <td>0.0696</td>
      <td>157.041</td>
      <td>4</td>
      <td>0.750</td>
      <td>41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.2810</td>
      <td>0.607</td>
      <td>228556</td>
      <td>0.771</td>
      <td>0.000005</td>
      <td>2</td>
      <td>0.2210</td>
      <td>-5.106</td>
      <td>1</td>
      <td>0.1120</td>
      <td>138.087</td>
      <td>4</td>
      <td>0.496</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>1.172930e+05</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
      <td>117293.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.342946</td>
      <td>0.581336</td>
      <td>2.125350e+05</td>
      <td>0.568661</td>
      <td>0.224272</td>
      <td>5.232247</td>
      <td>0.194912</td>
      <td>-9.987972</td>
      <td>0.608101</td>
      <td>0.112156</td>
      <td>119.464675</td>
      <td>3.878654</td>
      <td>0.439534</td>
      <td>24.152592</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.345778</td>
      <td>0.190210</td>
      <td>1.226774e+05</td>
      <td>0.260323</td>
      <td>0.360387</td>
      <td>3.602673</td>
      <td>0.167941</td>
      <td>6.549731</td>
      <td>0.488176</td>
      <td>0.124630</td>
      <td>30.154314</td>
      <td>0.514728</td>
      <td>0.259093</td>
      <td>19.664392</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.203000e+03</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.031600</td>
      <td>0.459000</td>
      <td>1.638140e+05</td>
      <td>0.395000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.097500</td>
      <td>-11.923000</td>
      <td>0.000000</td>
      <td>0.038900</td>
      <td>96.014000</td>
      <td>4.000000</td>
      <td>0.223000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.204000</td>
      <td>0.605000</td>
      <td>2.018130e+05</td>
      <td>0.602000</td>
      <td>0.000149</td>
      <td>5.000000</td>
      <td>0.124000</td>
      <td>-7.989000</td>
      <td>1.000000</td>
      <td>0.055900</td>
      <td>120.025000</td>
      <td>4.000000</td>
      <td>0.420000</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.638000</td>
      <td>0.727000</td>
      <td>2.410130e+05</td>
      <td>0.775000</td>
      <td>0.444000</td>
      <td>8.000000</td>
      <td>0.236000</td>
      <td>-5.690000</td>
      <td>1.000000</td>
      <td>0.129000</td>
      <td>139.646000</td>
      <td>4.000000</td>
      <td>0.638000</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.996000</td>
      <td>0.996000</td>
      <td>5.610020e+06</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>0.999000</td>
      <td>1.806000</td>
      <td>1.000000</td>
      <td>0.966000</td>
      <td>249.983000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 117293 entries, 0 to 117292
Data columns (total 14 columns):
acousticness        117293 non-null float64
danceability        117293 non-null float64
duration_ms         117293 non-null int64
energy              117293 non-null float64
instrumentalness    117293 non-null float64
key                 117293 non-null int64
liveness            117293 non-null float64
loudness            117293 non-null float64
mode                117293 non-null int64
speechiness         117293 non-null float64
tempo               117293 non-null float64
time_signature      117293 non-null int64
valence             117293 non-null float64
popularity          117293 non-null int64
dtypes: float64(9), int64(5)
memory usage: 12.5 MB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;popularity&#39;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;popularity&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; We have {len(X_train)} train rows + {len(X_valid)} valid rows&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="c1">#y_pred_test = model.predict(test_data[:2])</span>
<span class="c1">#y_pred_test</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> We have 93834 train rows + 23459 valid rows
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 8.41427276, 19.03573542])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(117293, 13)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>model.get_params returns a dictonary of all parameters for this estimators</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;activation&#39;: &#39;relu&#39;,
 &#39;alpha&#39;: 0.0001,
 &#39;batch_size&#39;: &#39;auto&#39;,
 &#39;beta_1&#39;: 0.9,
 &#39;beta_2&#39;: 0.999,
 &#39;early_stopping&#39;: False,
 &#39;epsilon&#39;: 1e-08,
 &#39;hidden_layer_sizes&#39;: (100,),
 &#39;learning_rate&#39;: &#39;constant&#39;,
 &#39;learning_rate_init&#39;: 0.001,
 &#39;max_fun&#39;: 15000,
 &#39;max_iter&#39;: 500,
 &#39;momentum&#39;: 0.9,
 &#39;n_iter_no_change&#39;: 10,
 &#39;nesterovs_momentum&#39;: True,
 &#39;power_t&#39;: 0.5,
 &#39;random_state&#39;: 1,
 &#39;shuffle&#39;: True,
 &#39;solver&#39;: &#39;adam&#39;,
 &#39;tol&#39;: 0.0001,
 &#39;validation_fraction&#39;: 0.1,
 &#39;verbose&#39;: False,
 &#39;warm_start&#39;: False}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-the-predictions">Evaluate the predictions<a class="anchor-link" href="#Evaluate-the-predictions"> </a></h3><p>model.score() returns the coefficient of determination $R^2$ of the prediction.</p>
<p>The coefficient $R^2$ is defined as $(1-(u/v))$</p>
<p>$u$ is the residual sum of squares $\sum(y_{true} - y_{pred})^2$</p>
<p>ans $v$ is the total sum of squares $\sum(y_{true} - \bar{y}_{true})^2$</p>
<p>the best possible score is 1.0 for $R^2$</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-0.299125312513981</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(117293, 14)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_merged</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/leandro/git/dslectures/env/lib/python3.7/site-packages/pandas/core/frame.py:7138: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &#39;sort=False&#39;.

To retain the current behavior and silence the warning, pass &#39;sort=True&#39;.

  sort=sort,
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_merged</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 130326 entries, 0 to 13032
Data columns (total 18 columns):
acousticness        130326 non-null float64
artist_name         13033 non-null object
collection_date     13033 non-null object
danceability        130326 non-null float64
duration_ms         130326 non-null int64
energy              130326 non-null float64
instrumentalness    130326 non-null float64
key                 130326 non-null int64
liveness            130326 non-null float64
loudness            130326 non-null float64
mode                130326 non-null int64
popularity          117293 non-null float64
speechiness         130326 non-null float64
tempo               130326 non-null float64
time_signature      130326 non-null int64
track_id            13033 non-null object
track_name          13033 non-null object
valence             130326 non-null float64
dtypes: float64(10), int64(4), object(4)
memory usage: 18.9+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_merged</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(130326, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">data_merged</span><span class="p">[</span><span class="s1">&#39;popularity&#39;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data_merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;popularity&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; We have {len(X_train)} train rows + {len(X_valid)} valid rows&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="c1">#y_pred_test = model.predict(test_data[:2])</span>
<span class="c1">#y_pred_test</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> We have 104260 train rows + 26066 valid rows
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-46-024fbb26004a&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39; We have {len(X_train)} train rows + {len(X_valid)} valid rows&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> model <span class="ansi-blue-fg">=</span> MLPRegressor<span class="ansi-blue-fg">(</span>random_state<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> max_iter<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">500</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg"> </span>model<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>X_train<span class="ansi-blue-fg">,</span> y_train<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span class="ansi-red-fg">#y_pred_test = model.predict(test_data[:2])</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> <span class="ansi-red-fg">#y_pred_test</span>

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/sklearn/neural_network/_multilayer_perceptron.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, X, y)</span>
<span class="ansi-green-intense-fg ansi-bold">    625</span>         self <span class="ansi-blue-fg">:</span> returns a trained MLP model<span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">    626</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 627</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_fit<span class="ansi-blue-fg">(</span>X<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> incremental<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    628</span> 
<span class="ansi-green-intense-fg ansi-bold">    629</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/sklearn/neural_network/_multilayer_perceptron.py</span> in <span class="ansi-cyan-fg">_fit</span><span class="ansi-blue-fg">(self, X, y, incremental)</span>
<span class="ansi-green-intense-fg ansi-bold">    323</span>                              hidden_layer_sizes)
<span class="ansi-green-intense-fg ansi-bold">    324</span> 
<span class="ansi-green-fg">--&gt; 325</span><span class="ansi-red-fg">         </span>X<span class="ansi-blue-fg">,</span> y <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_validate_input<span class="ansi-blue-fg">(</span>X<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> incremental<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    326</span>         n_samples<span class="ansi-blue-fg">,</span> n_features <span class="ansi-blue-fg">=</span> X<span class="ansi-blue-fg">.</span>shape
<span class="ansi-green-intense-fg ansi-bold">    327</span> 

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/sklearn/neural_network/_multilayer_perceptron.py</span> in <span class="ansi-cyan-fg">_validate_input</span><span class="ansi-blue-fg">(self, X, y, incremental)</span>
<span class="ansi-green-intense-fg ansi-bold">   1338</span>     <span class="ansi-green-fg">def</span> _validate_input<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> X<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> incremental<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1339</span>         X, y = check_X_y(X, y, accept_sparse=[&#39;csr&#39;, &#39;csc&#39;, &#39;coo&#39;],
<span class="ansi-green-fg">-&gt; 1340</span><span class="ansi-red-fg">                          multi_output=True, y_numeric=True)
</span><span class="ansi-green-intense-fg ansi-bold">   1341</span>         <span class="ansi-green-fg">if</span> y<span class="ansi-blue-fg">.</span>ndim <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">and</span> y<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1342</span>             y <span class="ansi-blue-fg">=</span> column_or_1d<span class="ansi-blue-fg">(</span>y<span class="ansi-blue-fg">,</span> warn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/sklearn/utils/validation.py</span> in <span class="ansi-cyan-fg">check_X_y</span><span class="ansi-blue-fg">(X, y, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, multi_output, ensure_min_samples, ensure_min_features, y_numeric, warn_on_dtype, estimator)</span>
<span class="ansi-green-intense-fg ansi-bold">    753</span>                     ensure_min_features<span class="ansi-blue-fg">=</span>ensure_min_features<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    754</span>                     warn_on_dtype<span class="ansi-blue-fg">=</span>warn_on_dtype<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 755</span><span class="ansi-red-fg">                     estimator=estimator)
</span><span class="ansi-green-intense-fg ansi-bold">    756</span>     <span class="ansi-green-fg">if</span> multi_output<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    757</span>         y = check_array(y, &#39;csr&#39;, force_all_finite=True, ensure_2d=False,

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/sklearn/utils/validation.py</span> in <span class="ansi-cyan-fg">check_array</span><span class="ansi-blue-fg">(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, warn_on_dtype, estimator)</span>
<span class="ansi-green-intense-fg ansi-bold">    529</span>                     array <span class="ansi-blue-fg">=</span> array<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">,</span> casting<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;unsafe&#34;</span><span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    530</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 531</span><span class="ansi-red-fg">                     </span>array <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>asarray<span class="ansi-blue-fg">(</span>array<span class="ansi-blue-fg">,</span> order<span class="ansi-blue-fg">=</span>order<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    532</span>             <span class="ansi-green-fg">except</span> ComplexWarning<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    533</span>                 raise ValueError(&#34;Complex data not supported\n&#34;

<span class="ansi-green-fg">~/git/dslectures/env/lib/python3.7/site-packages/numpy/core/_asarray.py</span> in <span class="ansi-cyan-fg">asarray</span><span class="ansi-blue-fg">(a, dtype, order)</span>
<span class="ansi-green-intense-fg ansi-bold">     83</span> 
<span class="ansi-green-intense-fg ansi-bold">     84</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 85</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> array<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> order<span class="ansi-blue-fg">=</span>order<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     86</span> 
<span class="ansi-green-intense-fg ansi-bold">     87</span> 

<span class="ansi-red-fg">ValueError</span>: could not convert string to float: &#34;The O&#39;Neill Brothers Group&#34;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_merged</span><span class="p">[</span><span class="mi">117294</span><span class="p">:</span><span class="mi">130326</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.99500</td>
      <td>0.234</td>
      <td>131000</td>
      <td>0.0637</td>
      <td>0.91800</td>
      <td>7</td>
      <td>0.2120</td>
      <td>-26.841</td>
      <td>0</td>
      <td>0.0433</td>
      <td>70.251</td>
      <td>4</td>
      <td>0.2010</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.78200</td>
      <td>0.591</td>
      <td>192697</td>
      <td>0.5580</td>
      <td>0.00000</td>
      <td>5</td>
      <td>0.6500</td>
      <td>-6.492</td>
      <td>0</td>
      <td>0.1200</td>
      <td>79.961</td>
      <td>4</td>
      <td>0.3970</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.07290</td>
      <td>0.660</td>
      <td>215381</td>
      <td>0.6480</td>
      <td>0.00000</td>
      <td>2</td>
      <td>0.1920</td>
      <td>-9.691</td>
      <td>1</td>
      <td>0.0480</td>
      <td>129.045</td>
      <td>4</td>
      <td>0.8360</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.98600</td>
      <td>0.472</td>
      <td>494418</td>
      <td>0.1140</td>
      <td>0.53400</td>
      <td>3</td>
      <td>0.1030</td>
      <td>-20.791</td>
      <td>1</td>
      <td>0.0613</td>
      <td>69.240</td>
      <td>3</td>
      <td>0.0345</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.00155</td>
      <td>0.831</td>
      <td>239518</td>
      <td>0.5870</td>
      <td>0.01810</td>
      <td>1</td>
      <td>0.0855</td>
      <td>-7.439</td>
      <td>1</td>
      <td>0.1150</td>
      <td>125.991</td>
      <td>4</td>
      <td>0.7860</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13028</th>
      <td>0.05220</td>
      <td>0.766</td>
      <td>144000</td>
      <td>0.5760</td>
      <td>0.00000</td>
      <td>7</td>
      <td>0.1130</td>
      <td>-9.302</td>
      <td>1</td>
      <td>0.0719</td>
      <td>149.955</td>
      <td>4</td>
      <td>0.6860</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13029</th>
      <td>0.99400</td>
      <td>0.432</td>
      <td>147347</td>
      <td>0.1440</td>
      <td>0.89300</td>
      <td>10</td>
      <td>0.1040</td>
      <td>-25.868</td>
      <td>1</td>
      <td>0.0389</td>
      <td>106.833</td>
      <td>4</td>
      <td>0.8860</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13030</th>
      <td>0.92600</td>
      <td>0.304</td>
      <td>102582</td>
      <td>0.1850</td>
      <td>0.92300</td>
      <td>3</td>
      <td>0.1570</td>
      <td>-31.639</td>
      <td>0</td>
      <td>0.0467</td>
      <td>172.967</td>
      <td>4</td>
      <td>0.8850</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13031</th>
      <td>0.02160</td>
      <td>0.632</td>
      <td>200250</td>
      <td>0.4980</td>
      <td>0.00000</td>
      <td>10</td>
      <td>0.1130</td>
      <td>-6.136</td>
      <td>0</td>
      <td>0.0377</td>
      <td>160.224</td>
      <td>4</td>
      <td>0.5320</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13032</th>
      <td>0.11500</td>
      <td>0.632</td>
      <td>200930</td>
      <td>0.6010</td>
      <td>0.00295</td>
      <td>10</td>
      <td>0.1200</td>
      <td>-6.940</td>
      <td>0</td>
      <td>0.3610</td>
      <td>172.324</td>
      <td>4</td>
      <td>0.3850</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>13032 rows × 14 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-78-4f9041aee366&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>y_pred_test <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>predict<span class="ansi-yellow-intense-fg ansi-bold">(</span>test_data<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py</span> in <span class="ansi-cyan-fg">predict</span><span class="ansi-blue-intense-fg ansi-bold">(self, X)</span>
<span class="ansi-green-fg">   1407</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">   1408</span>         check_is_fitted<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1409</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>y_pred <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_forward_pass_fast<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   1410</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> y_pred<span class="ansi-yellow-intense-fg ansi-bold">.</span>shape<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1411</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> y_pred<span class="ansi-yellow-intense-fg ansi-bold">.</span>ravel<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py</span> in <span class="ansi-cyan-fg">_forward_pass_fast</span><span class="ansi-blue-intense-fg ansi-bold">(self, X)</span>
<span class="ansi-green-fg">    132</span>             The decision function of the samples <span class="ansi-green-intense-fg ansi-bold">for</span> each <span class="ansi-green-intense-fg ansi-bold">class</span> <span class="ansi-green-intense-fg ansi-bold">in</span> the model<span class="ansi-yellow-intense-fg ansi-bold">.</span>
<span class="ansi-green-fg">    133</span>         &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">--&gt; 134</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>X <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_validate_data<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">,</span> accept_sparse<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#39;csr&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;csc&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> reset<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    135</span> 
<span class="ansi-green-fg">    136</span>         <span class="ansi-red-intense-fg ansi-bold"># Initialize first layer</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py</span> in <span class="ansi-cyan-fg">_validate_data</span><span class="ansi-blue-intense-fg ansi-bold">(self, X, y, reset, validate_separately, **check_params)</span>
<span class="ansi-green-fg">    435</span> 
<span class="ansi-green-fg">    436</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> check_params<span class="ansi-yellow-intense-fg ansi-bold">.</span>get<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;ensure_2d&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">True</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 437</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_check_n_features<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">,</span> reset<span class="ansi-yellow-intense-fg ansi-bold">=</span>reset<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    438</span> 
<span class="ansi-green-fg">    439</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> out

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py</span> in <span class="ansi-cyan-fg">_check_n_features</span><span class="ansi-blue-intense-fg ansi-bold">(self, X, reset)</span>
<span class="ansi-green-fg">    363</span> 
<span class="ansi-green-fg">    364</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> n_features <span class="ansi-yellow-intense-fg ansi-bold">!=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>n_features_in_<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 365</span><span class="ansi-yellow-intense-fg ansi-bold">             raise ValueError(
</span><span class="ansi-green-fg">    366</span>                 <span class="ansi-blue-intense-fg ansi-bold">f&#34;X has {n_features} features, but {self.__class__.__name__} &#34;</span>
<span class="ansi-green-fg">    367</span>                 f&#34;is expecting {self.n_features_in_} features as input.&#34;)

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: X has 13 features, but MLPRegressor is expecting 100 features as input.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">/</span><span class="s1">&#39;submitted/sample_submission.csv&#39;</span><span class="p">)</span>
<span class="n">submission</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;popularity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred_test</span>
<span class="n">submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">/</span><span class="s1">&#39;submitted/first_submission_schab9.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

